## 무중단 배포란?

말 그대로 서비스의 중단 없이 새로운 버전의 소프트웨어를 배포하는 것.

새로운 버전을 배포하기 위해선, 다음과 같은 두 단계가 필요하다 :

1. 기존의 서비스 종료
2. 새로운 서비스 시작

1번과 2번 과정의 사이 서비스가 중단되는 시간, 즉 시스템을 이용할 수 없는 시간을 **다운타임(Downtime)** 이라고 한다. 

다운타임은 사용자 경험과 서비스 신뢰도에 큰 영향을 미치기 때문에, 이를 줄이거나 없애는 것이 무중단 배포의 핵심이다.

---

## 무중단 배포 방식

### 1. Rolling Deployment

**개념**

사용 중인 인스턴스들에 새로운 버전의 서비스를 순차적으로 배포하는 방법. 무중단 배포의 가장 기본적인 방식

서비스 중인 인스턴스 하나를 로드 밸런서에서 제어한 뒤, 새로운 버전의 서비스를 배포하고 다시 라우팅 하는 과정을 반복한다.

**장점**

- 인스턴스마다 차례대로 배포를 진행하기 때문에 에러 등 이슈 발생 시 **쉽게 롤백 가능**
- 기존의 인스턴스에 추가적인 **인스턴스를 늘리지 않아도 됨**
- **단순한 구조**로 운영이 쉽고 관리에 용이

**단점**

- 배포 중에 처리 가능한 인스턴스 수가 감소하여 **일부 인스턴스에 과부하가 발생할 수** 있음
- 배포 과정에서 기존 버전과 새 버전이 공존하므로, 두 버전 간의 데이터 구조나 API 호환성을 신경 써야 함

---

### 2. Blue Green

**개념**

`blue` : 현재 운영 중인 기존 버전

`green` : 새로 배포될 버전

새 버전을 별도의 환경에 배포하고, 준비가 완료되면 로드 밸런서를 통해 모든 트래픽을 Green 버전으로 일제히 전환

**장점**

- 구 버전의 인스턴스(Blue)가 그대로 남아있어서 **빠른 롤백**이 가능
- Green 환경에서 실제 운영 환경과 동일한 테스트 가능
- 구 버전의 환경(Blue)을 다음 배포의 Green 환경으로 재사용할 수 있음

**단점**

- Blue와 Green 환경을 동시에 유지해야 하므로 두 배의 리소스가 필요

---

### 3. Canary

**개념**

새 버전을 특정 서버나 사용자 그룹에만 우선 배포하여 문제가 없는지 확인한 뒤, 점진적으로 전체에 배포하는 방법

Blue-Green과 달리 모든 트래픽을 한 번에 전환하지 않고, 단계적으로 확대 적용한다.

**장점**

- 문제가 발생하면 초기 단계에서 감지 가능
- 일부 트래픽을 통해 새 버전의 성능과 안전성을 점검할 수 있음
- 두 버전의 서비스를 실제 사용자들에게 동시 제공하여 비교하는 A/B 테스트 가능

**단점**

- 네트워크 트래픽 분산을 세밀하게 제어해야 하기 때문에 추가적인 관리 비용이 발생할 수 있다.

---

## 무중단 배포 방식 비교

| 배포 방식 | 장점 | 단점 | 적합한 상황 |
| --- | --- | --- | --- |
| **Rolling** | 쉬운 롤백, 추가 리소스 불필요, 단순한 구조 | 트래픽 과부하 가능성, 버전 호환성 이슈 | 리소스가 제한적이고 다운타임이 어느 정도 허용되는 경우 |
| **Blue-Green** | 빠른 롤백, 운영 환경에서의 테스트 가능 | 높은 비용 | 중요한 서비스로 다운타임이 절대 허용되지 않는 경우, 충분한 리소스가 있는 경우 |
| **Canary** | 문제 발생 시 초기 감지 가능, A/B 테스트 가능 | 트래픽 분산 제어로 추가 관리 비용 발생 | 새로운 기능의 안정성이나 성능 확인이 필요한 경우 |

---

## 주요 기술 소개

### AWS Elastic Beanstalk(EB)

**애플리케이션을 손쉽게 배포하고 관리할 수 있는 서비스**

개발자는 애플리케이션 코드를 업로드하기만 하면, Elastic Beanstalk가 자동으로 인프라를 설정하고, **무중단 배포**를 지원

**지원하는 무중단 배포 방식**

1. **Rolling 배포**: 기존 인스턴스를 순차적으로 업데이트
2. **Blue-Green 배포**: 새 환경에 배포 후 트래픽 전환

**장점**

- AWS 서비스(S3, CloudWatch 등)와의 통합
- 복잡한 설정 없이 무중단 배포를 쉽게 구현

---

### Kubernetes

**컨테이너 오케스트레이션 플랫폼**

주로 마이크로서비스 환경에서 사용되며, 다양한 **무중단 배포 전략**을 지원

**지원하는 무중단 배포 방식**

1. **Rolling Update**: 기존 버전의 파드를 점진적으로 교체
2. **Canary 배포**: 일부 파드에 새 버전을 먼저 배포
3. **Blue-Green 배포**: 두 개의 디플로이먼트를 생성해 트래픽 전환

**장점**

- 다양한 배포 전략을 유연하게 구현 가능
- 대규모 컨테이너 애플리케이션 관리에 적합

---

### Azure DevOps

**CI/CD 파이프라인을 구축하고 애플리케이션 배포를 자동화**할 수 있는 Microsoft 플랫폼

Azure Kubernetes Service(AKS), App Service 등과 통합하여 무중단 배포를 지원

**지원하는 무중단 배포 방식**

1. **Rolling 배포**: AKS와 연동해 기존 파드를 점진적으로 교체
2. **Blue-Green 배포**: App Service의 슬롯(Slot) 기능으로 트래픽 전환
3. **Canary 배포**: Application Gateway로 소규모 트래픽 분산

**장점**

- Microsoft 환경(.NET, GitHub)과 강력한 통합
- Azure 서비스와 쉽게 연계하여 간단하게 배포 가능




참고
https://hoehen-flug.tistory.com/53
